# Test: uvx ros-mcp installation from local repository
# This Dockerfile verifies that uvx can install and run ros-mcp from a local directory.
#
# Usage: docker build -f tests/installation/docker/Dockerfile.uvx-local .

FROM python:3.10-slim

# Install curl for downloading uv and OpenCV dependencies
RUN apt-get update && apt-get install -y --no-install-recommends \
    curl ca-certificates libgl1 libglib2.0-0 && \
    rm -rf /var/lib/apt/lists/*

# Install uv (as documented in installation.md)
RUN curl -LsSf https://astral.sh/uv/install.sh | sh

# Add uv to PATH
ENV PATH="/root/.local/bin:$PATH"

# Verify uv is installed
RUN uv --version

# Copy the repository (build context should be repo root)
COPY . /ros-mcp-server
WORKDIR /ros-mcp-server

# Run ros-mcp using uvx from local repository
# This installs and runs ros-mcp from the current directory
RUN uvx . ros-mcp --help

